<!DOCTYPE html>
<html lang="en">
{% include 'head.html' %}

<body>
    <!-- Navbar Start -->
    {% set current_page = 'upload' %}
    {% include 'navbar.html' %}
    <!-- Navbar End -->
    <!-- Body Start -->
    <center>
        <div class="upload-section">
            <h1 class="text-center">Upload Files</h1>
            <div class="row">
                <div class="col-md-6 text-center">
                    <img id="fileImage" class="file-image" src="/static/images/file.png" alt="" width="200px"
                        height="200px">
                </div>
                <div class="col-md-6">
                    {% with messages = get_flashed_messages() %}
                    {% if messages %}
                    <ul class="flashes">
                        {% for message in messages %}
                        <li>{{ message }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                    {% endwith %}

                    <form action="/" method="post" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label for="formFileMultiple" class="form-label"
                                style="font-size: larger; font-weight: bold;">แบบฟอร์ม</label>
                            <input name="files[]" class="form-control custom-file-input" type="file"
                                id="formFileMultiple" multiple required onchange="updateImage()">
                        </div>
                        <div class="mb-3">
                            <label for="inputTelTime" class="form-label"
                                style="font-weight: bold;">ลงชื่อผู้เบิก</label>
                            <input type="text" class="form-control" id="inputName" name="inputName"
                                placeholder="เช่น พงศ์นรา นาคดี" required>
                        </div>
                        <button type="submit" class="btn btn-success btn-lg">PROCESS</button>
                    </form>
                </div>
            </div>
        </div>
    </center>
    <!-- Body End -->
    <script>
        function updateImage() {
            const input = document.getElementById("formFileMultiple");
            const image = document.getElementById("fileImage");

            // Display the first selected file's image or reset to the upload image icon
            if (input.files && input.files.length > 0) {
                const firstFile = input.files[0];
                if (firstFile.type.startsWith("image/")) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        image.src = e.target.result;
                    };
                    reader.readAsDataURL(firstFile);
                } else {
                    image.src = "/static/images/documents.png";
                }
            } else {
                image.src = "/static/images/file.png";
            }
        }

        document.getElementById("formFileMultiple").addEventListener("change", updateImage);
    </script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
</body>

</html>